@{
    ViewData["Title"] = "Crear";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model Siscan_Vc_AppWeb.Models.ViewModels.Viewmodelsegui

<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-7">
            <div class="card shadow-lg border-0 rounded-lg mt-5">
                <div class="card-header fondomenu ">
                    <h3 class="text-center font-dark-light my-4">Seguimiento </h3>
                </div>
                <form method="post" asp-action="Crear">
                    <div class="card-body">
                        @if (TempData["MensajeAlertSegui"] != null)
                        //validacion manejada con el tempdata desde el controlador y tiene una funcion para que redireccione a una vista despues de 3 segundos
                        {
                            <div class="alert alert-success" role="alert"> @TempData["MensajeAlertSegui"] </div>
                            <script>
                                setTimeout(function () {
                                    window.location.href = '@Url.Action("Index", "Seguimiento")';
                                }, 3000);
                            </script>
                        }
                        @if (TempData["MensajeAlertEmpre"] != null)
                        {
                            <div class="alert alert-danger" role="alert"> @TempData["MensajeAlertEmpre"] </div>
                        }
                        @if (TempData["MensajeAlertInstruc"] != null)
                        {
                            <div class="alert alert-danger" role="alert"> @TempData["MensajeAlertInstruc"] </div>
                        }
                        @*datos del aprendiz*@
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input asp-for="tipoDocAprendiz" class="form-control form-control-sm" id="cboTipoDocumento" readonly />
                                    <label asp-for="seguimientoinstructorAprendiz.NumeroDocumentoAprendizNavigation.IdTipodocumento">Tipo Documento</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3 mb-md-0">
                                    <input asp-for="aprendiz.NumeroDocumentoAprendiz" class="form-control" id="inputDocumento" type="text" readonly />
                                    <label asp-for="seguimientoinstructorAprendiz.NumeroDocumentoAprendiz">Numero de documento</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3 mb-md-0">
                                    <input readonly asp-for="aprendiz.NombreAprendiz" class="form-control" id="inputNombre" type="text" placeholder="Ingresa tus nombres" />
                                    <label asp-for="seguimientoinstructorAprendiz.NumeroDocumentoAprendizNavigation.NombreAprendiz">Nombres</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input readonly asp-for="aprendiz.ApellidoAprendiz" class="form-control" id="inputApellidos" type="text" placeholder="Ingresa tus apellidos" />
                                    <label asp-for="seguimientoinstructorAprendiz.NumeroDocumentoAprendizNavigation.ApellidoAprendiz">Apellidos</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--datos de empresa-->
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div id="dvinputEmpresa" class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.NitEmpresa" class="form-control" id="inputEmpresa" type="text" placeholder="Digite el nit de la Empresa">
                                    <label asp-for="seguimientoinstructorAprendiz.NitEmpresa" class="form-label">Digite el Nit de la Empresa</label>
                                </div>

                                <div id="dvinputNitPoryecto" class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.NitProyecto" class="form-control" id="inputNitPoryecto" type="text" placeholder="Digite el nit del proyecto">
                                    <label asp-for="seguimientoinstructorAprendiz.NitProyecto" class="form-label">Digite el Nit del proyecto</label>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <select asp-for="seguimientoinstructorAprendiz.IdModalidad" asp-items="@Model.listaopcModalidad" class="form-control form-control-sm" id="cboModalidad">
                                        <option value="">Selecciona una Modalidad...</option>
                                    </select>
                                    <label asp-for="seguimientoinstructorAprendiz.IdModalidad">Modalidad Practicas</label>
                                    <span asp-validation-for="seguimientoinstructorAprendiz.IdModalidad" class="text-danger"></span>
                                </div>
                            </div>

                            <div id="dvIptNombreProyecto" class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.NombreProyecto" class="form-control" id="inputNomProyecto" style="width:340px;" type="text" placeholder="Digite el nombre del proyecto" />
                                    <label asp-for="seguimientoinstructorAprendiz.NombreProyecto" class="form-label">Nombre del Proyecto</label>
                                </div>
                            </div>

                            <div id="dvIptObjetivoProyecto" class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.ObjetivoProyecto" class="form-control" id="inputObjProyecto" style="width:340px;" type="text" placeholder="Digite objetivo del proyecto" />
                                    <label asp-for="seguimientoinstructorAprendiz.ObjetivoProyecto" class="form-label">Objetivo del Proyecto</label>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.FechaInicio" class="form-control" id="FechaInicio" type="date" />
                                    <label asp-for="seguimientoinstructorAprendiz.FechaInicio">Inicio</label>
                                    <span asp-validation-for="seguimientoinstructorAprendiz.FechaInicio" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.FechaFinalizacion" class="form-control" id="FechaFinal" type="date" />
                                    <label asp-for="seguimientoinstructorAprendiz.FechaFinalizacion">Finaliza</label>
                                    <span asp-validation-for="seguimientoinstructorAprendiz.FechaFinalizacion" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <select asp-for="seguimientoinstructorAprendiz.IdAreaEmpresa" asp-items="Model.listaopcAreaEmpre" class="form-control form-control-sm" id="cboAsignacionArea">
                                        <option value="">Selecciona un Area...</option>
                                    </select>
                                    <label asp-for="seguimientoinstructorAprendiz.IdAreaEmpresa">Area de Practicas</label>
                                    <span asp-validation-for="seguimientoinstructorAprendiz.IdAreaEmpresa" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input asp-for="seguimientoinstructorAprendiz.FechaRealizacionSeguimiento" type="date" class="form-control" id="fechaRealizacion" />
                                    <label asp-for="seguimientoinstructorAprendiz.FechaRealizacionSeguimiento">Fecha de realizacion</label>
                                    <span asp-validation-for="seguimientoinstructorAprendiz.FechaRealizacionSeguimiento" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="row mb-3">
                                <!-- Coformador -->
                                <div class="fondomenu py-3 px-5">
                                    <h6 class="m-0 text-center font-dark-light text-white">Coformador</h6>
                                </div>
                                <br />
                                <div class="form-floating mb-3 mb-md-0 py-3">
                                    <div class="form-floating mb-3">
                                        <select asp-for="seguimientoinstructorAprendiz.IdCoformador" asp-items="Model.listaopcCoform" class="form-control form-control-sm" id="cbocoformador">
                                            <option value="">Selecciona un Coformador...</option>
                                        </select>
                                        <label asp-for="seguimientoinstructorAprendiz.IdCoformador">Coformador</label>
                                    </div>
                                </div>

                                <!-- Instructor-->
                                <div class="fondomenu py-3 px-5">
                                    <h6 class="m-0 text-center font-dark-light text-white "> Instructor</h6>
                                </div>
                                <br />
                                <div class="form-floating mb-3 mb-md-0 py-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input asp-for="seguimientoinstructorAprendiz.NumeroDocumentoInstructor" class="form-control" id="inputInstructor" type="text" placeholder="Numero Documento Instructor" />
                                            <label asp-for="seguimientoinstructorAprendiz.NumeroDocumentoInstructor">Numero documento Instructor</label>
                                            <span asp-validation-for="seguimientoinstructorAprendiz.NumeroDocumentoInstructor" class="text-danger"></span>
                                        </div>
                                    </div>
                                </div>

                                <!--Agregar Actividades-->
                                <div class="mb-3">
                                    <button type="button" class="w-100 btn btn-primary" id="addActivityButton">Agregar Actividad</button>
                                </div>

                                <!--Agregar Observaciones-->
                                <div id="additionalActivities"></div>
                                <div class="mb-3">
                                    <button type="button" class="w-100 btn btn-primary" id="addObservationButton">Agregar Observación</button>
                                </div>

                                <div id="additionalObservations"></div>
                                <div class="mt-4 mb-0">
                                    <div class="d-grid boton2"><button type="submit" id="confirmarRegistro" class="btn text-center btn-block" style="font-size:20px" onclick="return confirmCrear()">Registrar</button></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script src="~/js/scripts.js" asp-append-version="true"></script>
    <script>
        function confirmCrear() {
            return confirm("¿Estás seguro de que deseas Guardar?");
        }

        //cambios en el formulario dependiendo de la modalidad
        let Modalidad = document.querySelector('#cboModalidad');
        let inputEmpresa = document.querySelector('#dvinputEmpresa');
        let inputPoryecto = document.querySelector('#dvinputNitPoryecto');
        let nombreProyecto = document.querySelector('#dvIptNombreProyecto');
        let objetivoProyecto = document.querySelector('#dvIptObjetivoProyecto');
        let coformador = document.querySelector('#cbocoformador');

        window.addEventListener('load', () => {
            var opciones = Modalidad.options[Modalidad.selectedIndex];

            if (opciones.text.toLowerCase() == 'proyecto productivo') {
                inputEmpresa.style.display = "none";
                coformador.disabled = true;
                inputPoryecto.style.display = "flex";
                nombreProyecto.style.display = "flex";
                objetivoProyecto.style.display = "flex";
            } else {
                inputPoryecto.style.display = "none";
                objetivoProyecto.style.display = "none";
                nombreProyecto.style.display = "none";
            }
        });
        Modalidad.addEventListener('change', () => {
            var opciones = Modalidad.options[Modalidad.selectedIndex];

            if (opciones.text.toLowerCase() == 'proyecto productivo') {
                inputEmpresa.style.display = "none";
                coformador.disabled = true;
                inputPoryecto.style.display = "flex";
                nombreProyecto.style.display = "flex";
                objetivoProyecto.style.display = "flex";
            } else {
                inputPoryecto.style.display = "none";
                objetivoProyecto.style.display = "none";
                nombreProyecto.style.display = "none";
                inputEmpresa.style.display = "flex";
                coformador.disabled = false;
            }
        });
    </script>
    <script>
        document.getElementById('addActivityButton').addEventListener('click', function () {
            //funcion creada para que cuando le de al boton se crea un textarea
            const container = document.getElementById('additionalActivities');
            const textareaCount = container.getElementsByTagName('textarea').length + 1;

            const newTextarea = document.createElement('div');
            newTextarea.classList.add('form-floating', 'mb-3');

            newTextarea.innerHTML = `
                              <textarea name="actividadesList" class="form-control" rows="3" placeholder="Actividad ${textareaCount}"></textarea>
                              <label>Actividad ${textareaCount}</label>
                    `;

            container.appendChild(newTextarea);
        });
        //funcion creada para que cuando le de al boton se crea un textarea
        document.getElementById('addObservationButton').addEventListener('click', function () {
            const container = document.getElementById('additionalObservations');
            const textareaCount = container.getElementsByTagName('textarea').length + 1;

            const newTextarea = document.createElement('div');
            newTextarea.classList.add('form-floating', 'mb-3');

            newTextarea.innerHTML = `
                          <textarea name="observacionesList" class="form-control" rows="3" placeholder="Observación ${textareaCount}"></textarea>
                          <label>Observación ${textareaCount}</label>
                    `;

            container.appendChild(newTextarea);
        });
    </script>
}

